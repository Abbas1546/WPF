<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"  xmlns:shared="clr-namespace:Syncfusion.Windows.Shared;assembly=Syncfusion.Shared.WPF"
    xmlns:local="clr-namespace:Syncfusion.Windows.Tools.Controls;assembly=Syncfusion.Tools.Wpf" xmlns:utilsOuter="clr-namespace:Syncfusion.Windows.Shared;assembly=Syncfusion.Shared.WPF"
    xmlns:Microsoft_Windows_Themes="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Luna">  
           
    <SolidColorBrush x:Key="Aero.ButtonInactivePathBrush" Color="Black"/>            
    <SolidColorBrush x:Key="Aero.ContentPanelBorderBrush" Color="#69A1BF"/>
    <SolidColorBrush x:Key="Aero.ContentPanelBackgroundBrush" Color="#D2E6FA"/>                        
    <SolidColorBrush x:Key="Aero.SplitterButtonActiveBorderBrush" Color="#3E89F9"/>    
    <SolidColorBrush x:Key="Aero.SplitterButtonHoverBackgroundBrush" Color="#C1D2EE"/>
    <SolidColorBrush x:Key="Aero.SplitterButtonPressedBorderBrush" Color="#316AC5"/>
    <SolidColorBrush x:Key="Aero.SplitterButtonPressedBackgroundBrush" Color="#98B5E2"/>     
       
    <LinearGradientBrush x:Key="Aero.GridSplitterBackground" StartPoint="0,0" EndPoint="0,1">
        <LinearGradientBrush.GradientStops>
            <GradientStop Color="#BEBCC0" Offset="0" />
            <GradientStop Color="#EFF2FF" Offset="0.2" />
            <GradientStop Color="#F0EDF4" Offset="0.7" />
            <GradientStop Color="#F9F4FF" Offset="1" />
        </LinearGradientBrush.GradientStops>
    </LinearGradientBrush>

    <local:CloseButtonTypeToVisibilityConverter x:Key="CloseButtonTypeToVisibilityConverter"/>
    <shared:BooleanToVisibilityConverterEx x:Key="BooleanToVisibilityConverterEx"/>    

    <SolidColorBrush Color="#FFCED4DD" x:Key="VS2010MenuButtonPathFill"/>   
    <SolidColorBrush x:Key="Office2007.Blue.ButtonInactivePathBrush" Color="Black"/>
    <SolidColorBrush x:Key="Office2007.Blue.ButtonInactiveBorderBrush" Color="Transparent"/>   
  
    <SolidColorBrush Color="#FFFFFCF4" x:Key="VS2010MenuButtonHoverBackgroundBrush"/>
    <SolidColorBrush Color="#FFE5C365" x:Key="VS2010MenuButtonHoverBorderBrush"/>      
   
    <SolidColorBrush x:Key="VS2010TabPanelBackground" Color="Red"/>

    <Style x:Key="Office2007BlueTabPanelStyle" TargetType="{x:Type local:TabPanelAdv}">
        <Setter Property="SnapsToDevicePixels" Value="True"/>
        <Setter Property="Background" Value="{StaticResource VS2010TabPanelBackground}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:TabPanelAdv}">
                    <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
							Padding="{TemplateBinding Padding}"
							CornerRadius="{TemplateBinding CornerRadius}"
                            HorizontalAlignment="Left" VerticalAlignment="Top">
                        <DockPanel LastChildFill="True">
                            <Border Name="BottomBorder" Height="4" DockPanel.Dock="Bottom" Background="#FFFFE8A6" CornerRadius="1.5,1.5,0,0"/>

                            <ContentPresenter x:Name="PART_CustomItems" AllowDrop="False" ContentSource="TabPanelItem"
                                              MaxHeight="{Binding Path=ActualHeight, ElementName=PART_TabItems}" Margin="2,0,0,0" DockPanel.Dock="Right" 
                                              Content="{Binding Path=TabPanelItem, Mode=OneWay, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:TabControlExt}}}"/>
                            <ToggleButton Name="PART_CloseButton" Width="15" Height="15"
                                  DockPanel.Dock="Right" 
                                  Focusable="False" 
                                  AllowDrop="False"
                                  Visibility="{Binding Path=CloseButtonType, Converter={StaticResource CloseButtonTypeToVisibilityConverter}, Mode=OneWay, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:TabControlExt}}}"
                                  Command="local:TabSplitterCommands.CloseCurrentTabSplitterItem"
                                  >
                                <ToggleButton.Template>
                                    <ControlTemplate TargetType="{x:Type ButtonBase}">
                                        <shared:Border3D x:Name="brdBack" Margin="1" BorderThickness="1"
                                            BorderBrush="Transparent">
                                            <Path Name="pathButton" SnapsToDevicePixels="False" Stretch="Fill" StrokeThickness="1.5"
				                                    Stroke="{StaticResource VS2010MenuButtonPathFill}"
                                                    Data="M109,51 L216,142 M215,52 L109,142"
				                                    HorizontalAlignment="Center" VerticalAlignment="Center" Width="9" Height="8"/>
                                        </shared:Border3D>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsPressed" Value="True">
                                                <Setter TargetName="brdBack" Property="IsInverted" Value="True"/>
                                                <Setter Property="Content" Value="1,1,-1,-1"/>
                                            </Trigger>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="brdBack" Property="Background" Value="{StaticResource VS2010MenuButtonHoverBackgroundBrush}"/>
                                                <Setter TargetName="brdBack" Property="BorderBrush" Value="{StaticResource VS2010MenuButtonHoverBorderBrush}"/>
                                                <Setter TargetName="pathButton" Property="Stroke" Value="Black" />
                                                <Setter TargetName="pathButton" Property="Fill" Value="Black" />
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </ToggleButton.Template>
                            </ToggleButton>
                            <ToggleButton Name="PART_MenuButton" Width="15" Height="15"                                          
                                  DockPanel.Dock="Right" 
                                  AllowDrop="False"
                                  Focusable="False"  
                                  Visibility="{Binding Path=ShowTabListContextMenu, Converter={StaticResource BooleanToVisibilityConverterEx}, Mode=OneWay, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:TabControlExt}}}"
                                  Command="local:TabSplitterCommands.OpenContextMenu"
                                  >
                                <ToggleButton.Template>
                                    <ControlTemplate TargetType="{x:Type ButtonBase}">
                                        <shared:Border3D x:Name="brdBack" BorderThickness="1"
                BorderBrush="{StaticResource Office2007.Blue.ButtonInactiveBorderBrush}">
                                            <Path Name="pathButton" SnapsToDevicePixels="True"
				Fill="{StaticResource VS2010MenuButtonPathFill}"
				HorizontalAlignment="Center" VerticalAlignment="Center"
				Width="8" Height="8">
                                                <Path.Data>
                                                    <GeometryGroup>
                                                        <PathGeometry>
                                                            <PathFigure StartPoint="0,1" IsFilled="True" IsClosed="True">
                                                                <LineSegment Point="8,1"/>
                                                                <LineSegment Point="8,3"/>
                                                                <LineSegment Point="0,3"/>
                                                            </PathFigure>
                                                        </PathGeometry>
                                                        <PathGeometry>
                                                            <PathFigure StartPoint="0,4" IsFilled="True" IsClosed="True">
                                                                <LineSegment Point="4,8"/>
                                                                <LineSegment Point="8,4"/>
                                                            </PathFigure>
                                                        </PathGeometry>
                                                    </GeometryGroup>
                                                </Path.Data>
                                            </Path>
                                        </shared:Border3D>
                                        <ControlTemplate.Triggers>
                                            <DataTrigger Binding="{Binding Path=IsAllItemsVisible,RelativeSource={RelativeSource TemplatedParent}}" Value="True">
                                                <Setter TargetName="pathButton" Property="Data" Value="M0,4 L4,8 L8,4 z"/>
                                            </DataTrigger>
                                            <Trigger Property="IsPressed" Value="True">
                                                <Setter TargetName="brdBack" Property="IsInverted" Value="True"/>
                                            </Trigger>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="brdBack" Property="Background" Value="{StaticResource VS2010MenuButtonHoverBackgroundBrush}"/>
                                                <Setter TargetName="brdBack" Property="BorderBrush" Value="{StaticResource VS2010MenuButtonHoverBorderBrush}"/>
                                                <Setter TargetName="pathButton" Property="Fill" Value="Black"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </ToggleButton.Template>
                            </ToggleButton>
                            <ContentPresenter x:Name="PART_TabItems" ContentSource="TabItems"
                                              DockPanel.Dock="Right" 
                                              Content="{TemplateBinding Content}"/>
                        </DockPanel>
                    </Border>
                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding Path=TabStripPlacement,RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type TabControl}}}" Value="Bottom">
                            <Setter Property="LayoutTransform" TargetName="PART_CustomItems">
                                <Setter.Value>
                                    <RotateTransform Angle="-180"/>
                                </Setter.Value>
                            </Setter>
                            <Setter Property="LayoutTransform" TargetName="PART_CloseButton">
                                <Setter.Value>
                                    <RotateTransform Angle="-180"/>
                                </Setter.Value>
                            </Setter>
                            <Setter Property="LayoutTransform" TargetName="PART_MenuButton">
                                <Setter.Value>
                                    <RotateTransform Angle="-180"/>
                                </Setter.Value>
                            </Setter>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Path=IsAllTabsClosed,RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:TabControlExt}}}" Value="True">
                            <Setter TargetName="PART_CloseButton" Property="Visibility" Value="Hidden"/>
                            <Setter TargetName="PART_MenuButton" Property="Visibility" Value="Hidden"/>
                            <Setter TargetName="BottomBorder" Property="Height" Value="0"/>
                        </DataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
    <Style TargetType="{x:Type local:TabSplitter}" x:Key="Style1">
        <Setter Property="Control.Template" >
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:TabSplitter}">
                    <Border Name="border"
			            BorderThickness="{TemplateBinding BorderThickness}"
                        BorderBrush="{TemplateBinding BorderBrush}"
		                Background="{TemplateBinding Background}">
                        <Grid Background="Transparent" ClipToBounds="False" SnapsToDevicePixels="True"
				            KeyboardNavigation.TabNavigation="Local">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Name="ColumnDefinition0" />
                                <ColumnDefinition Width="0" Name="ColumnDefinition1" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="0" Name="RowDefinition0" />
                                <RowDefinition Height="*" Name="RowDefinition1" />
                            </Grid.RowDefinitions>
                            <local:LayoutPanel Grid.Column="0" Grid.Row="0" Panel.ZIndex="1" Name="HeaderPanel" Focusable="False"
											   HorizontalAlignment="Left" VerticalAlignment="Top"   >
                                <local:TabPanelAdv x:Name="PART_TabPanel"   Focusable="False"  DockPanel.Dock="Right"
												   HorizontalAlignment="Left" VerticalAlignment="Top" Style="{StaticResource Office2007BlueTabPanelStyle}"
												  
                                               >
                                    <local:TabSplitterItemPanel x:Name="PART_TabLayoutPanel" AllowDrop="False" Margin="0,0,2,0" IsItemsHost="True"
													KeyboardNavigation.TabIndex="1"  HorizontalAlignment="Left" VerticalAlignment="Top"/>
                                </local:TabPanelAdv>
                            </local:LayoutPanel>
                            <shared:Border3D Grid.Column="0" Grid.Row="1" AllowDrop="False"
									BorderThickness="1"
									CornerRadius="2"
									Name="ContentPanel" KeyboardNavigation.TabIndex="2" KeyboardNavigation.TabNavigation="Local"
									BorderBrush="{StaticResource Aero.ContentPanelBorderBrush}"
									Background="{StaticResource Aero.ContentPanelBackgroundBrush}"
									KeyboardNavigation.DirectionalNavigation="Contained">
                                <Border x:Name="PART_ContentPanelBorder"
							        BorderBrush="{StaticResource Aero.ContentPanelBorderBrush}"
							        BorderThickness="0"
							        Background="White"
							        CornerRadius="2">

                                    <Grid Name="ResizedContentGrid" >
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <local:LayoutPanel x:Name="PART_TopPanel" Grid.Row="0" Grid.Column="1" >
                                            <ScrollContentPresenter x:Name="PART_TopScrollContent"
															Content="{TemplateBinding TopSelectedContent}"
															ContentSource="TopSelectedContent"
															Margin="{Binding Path=Padding, RelativeSource={RelativeSource AncestorType={x:Type local:TabSplitter}}}"
														/>
                                        </local:LayoutPanel>
                                        <local:CustomGridSplitter x:Name="PART_Splitter" Grid.Row="1" Grid.Column="1"
														  Panel.ZIndex="1" ShowsPreview="True" ResizeDirection="Rows" >
                                            <local:CustomGridSplitter.Style>
                                                <Style TargetType="{x:Type local:CustomGridSplitter}">
                                                    <Setter Property="Height" Value="22"/>
                                                    <Setter Property="HorizontalAlignment" Value="Center"/>
                                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                                    <Setter Property="Template" >
                                                        <Setter.Value>
                                                            <ControlTemplate  TargetType="{x:Type local:CustomGridSplitter}">
                                                                <local:LayoutPanel x:Name="PART_SplitHeaderPanel" Panel.ZIndex="1"
                                                                           Height="{Binding Path=ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type local:CustomGridSplitter}}}">
                                                                    <Border x:Name="PART_SplitBorder" 
                                                                            BorderBrush="#A0A0A0" BorderThickness="1" Background="{StaticResource Aero.GridSplitterBackground}">
                                                                        <local:SplitHeaderPanel>
                                                                            <ItemsControl x:Name="PART_TopPages" DockPanel.Dock="Left" >
                                                                                <ItemsControl.ItemsPanel>
                                                                                    <ItemsPanelTemplate>
                                                                                        <local:PagesLayoutPanel >
                                                                                            <local:PagesLayoutPanel.LayoutTransform>
                                                                                                <RotateTransform Angle="-180"/>
                                                                                            </local:PagesLayoutPanel.LayoutTransform>
                                                                                        </local:PagesLayoutPanel>
                                                                                    </ItemsPanelTemplate>
                                                                                </ItemsControl.ItemsPanel>
                                                                            </ItemsControl>
                                                                            <Button x:Name="PART_SplitButton" 
							                                                                    DockPanel.Dock="Left" ToolTip="Swap Panes" Margin="3,0,0,0">
                                                                                <Button.Style>
                                                                                    <Style TargetType="{x:Type Button}">
                                                                                        <Setter Property="Template" >
                                                                                            <Setter.Value>
                                                                                                <ControlTemplate TargetType="{x:Type Button}">
                                                                                                    <Border x:Name="PART_Border" VerticalAlignment="Center" HorizontalAlignment="Center" 
				                                                                                                Margin="1,0,1,0"                
                                                                                                                Width="15"
                                                                                                                Height="15" 
                                                                                                                Background="Transparent"
                                                                                                                BorderBrush="Transparent"
                                                                                                                BorderThickness="1"                
				                                                                                                SnapsToDevicePixels="True"
				                                                                                                CornerRadius="0">
                                                                                                        <Canvas Width="13" Height="13" SnapsToDevicePixels="True">
                                                                                                            <Path Data="M3,11L3,5" HorizontalAlignment="Center" Stroke="{StaticResource Aero.ButtonInactivePathBrush}" Fill="{StaticResource Aero.ButtonInactivePathBrush}" VerticalAlignment="Center"/>
                                                                                                            <Path Data="M 1,5L4.5,5 3,3 1.5,5" HorizontalAlignment="Center" Stroke="{StaticResource Aero.ButtonInactivePathBrush}" Fill="{StaticResource Aero.ButtonInactivePathBrush}" VerticalAlignment="Center"/>
                                                                                                            <Path Data="M9,8L9,1" HorizontalAlignment="Center" Stroke="{StaticResource Aero.ButtonInactivePathBrush}" Fill="{StaticResource Aero.ButtonInactivePathBrush}" VerticalAlignment="Center"/>
                                                                                                            <Path Data="M 7,8L10.5,8 9,10 7.5,8" HorizontalAlignment="Center" Stroke="{StaticResource Aero.ButtonInactivePathBrush}" Fill="{StaticResource Aero.ButtonInactivePathBrush}" VerticalAlignment="Center"/>
                                                                                                        </Canvas>
                                                                                                    </Border>
                                                                                                    <ControlTemplate.Triggers>
                                                                                                        <Trigger Property="IsMouseOver" Value="True">
                                                                                                            <Setter Property="Background" TargetName="PART_Border" Value="{StaticResource Aero.SplitterButtonHoverBackgroundBrush}"/>
                                                                                                            <Setter Property="BorderBrush" TargetName="PART_Border" Value="{StaticResource Aero.SplitterButtonActiveBorderBrush}"/>
                                                                                                            <!--<Setter Property="Background" TargetName="PART_Border" Value="#ADD8E6"/>
				                                                                                                <Setter Property="BorderBrush" TargetName="PART_Border" Value="#0000FF"/>-->
                                                                                                        </Trigger>
                                                                                                        <Trigger Property="IsPressed" Value="True">
                                                                                                            <Setter Property="Background" TargetName="PART_Border" Value="{StaticResource Aero.SplitterButtonPressedBackgroundBrush}"/>
                                                                                                            <Setter Property="BorderBrush" TargetName="PART_Border" Value="{StaticResource Aero.SplitterButtonPressedBorderBrush}"/>
                                                                                                            <!--<Setter Property="Background" TargetName="PART_Border" Value="#98B5E2"/>
				                                                                                                <Setter Property="BorderBrush" TargetName="PART_Border" Value="#316AC5"/>-->
                                                                                                        </Trigger>
                                                                                                    </ControlTemplate.Triggers>
                                                                                                </ControlTemplate>
                                                                                            </Setter.Value>
                                                                                        </Setter>
                                                                                    </Style>
                                                                                </Button.Style>
                                                                            </Button>
                                                                            <ItemsControl x:Name="PART_BottomPages" DockPanel.Dock="Left" >
                                                                                <ItemsControl.ItemsPanel>
                                                                                    <ItemsPanelTemplate>
                                                                                        <local:PagesLayoutPanel/>
                                                                                    </ItemsPanelTemplate>
                                                                                </ItemsControl.ItemsPanel>
                                                                            </ItemsControl>
                                                                            <DockPanel x:Name="PART_SplitterMunuPanel" HorizontalAlignment="Right" DockPanel.Dock="Right"  Margin="0,1,0,0">
                                                                                <Button x:Name="PART_VerticalButton" ToolTip="Vertical Split">
                                                                                    <Button.Style>
                                                                                        <Style TargetType="{x:Type Button}">
                                                                                            <Setter Property="Background" Value="Transparent"/>
                                                                                            <Setter Property="BorderBrush" Value="Transparent"/>
                                                                                            <Setter Property="BorderThickness" Value="1"/>
                                                                                            <Setter Property="Template" >
                                                                                                <Setter.Value>
                                                                                                    <ControlTemplate TargetType="{x:Type Button}">
                                                                                                        <Border x:Name="PART_Border" VerticalAlignment="Center" HorizontalAlignment="Center" 
				                                                                                                        Margin="0,0,0,0"                 
                                                                                                                        Width="15"
                                                                                                                        Height="15" 
                                                                                                                        Background="{TemplateBinding Background}"
                                                                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                                                                        BorderThickness="{TemplateBinding BorderThickness}"                  
				                                                                                                        SnapsToDevicePixels="True"
				                                                                                                        CornerRadius="0">
                                                                                                            <Canvas Width="11" Height="11" SnapsToDevicePixels="True" VerticalAlignment="Center"  HorizontalAlignment="Center">
                                                                                                                <Rectangle Stroke="Black"  Width="11"  Height="11"/>
                                                                                                                <Path  Name="VericalLine" Data="M5.5,8.8L5.5,2.5"  HorizontalAlignment="Center" Stroke="Black" Fill="Black" VerticalAlignment="Center"/>
                                                                                                            </Canvas>
                                                                                                        </Border>
                                                                                                        <ControlTemplate.Triggers>
                                                                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                                                                <Setter Property="Background" TargetName="PART_Border" Value="{StaticResource Aero.SplitterButtonHoverBackgroundBrush}"/>
                                                                                                                <Setter Property="BorderBrush" TargetName="PART_Border" Value="{StaticResource Aero.SplitterButtonActiveBorderBrush}"/>
                                                                                                                <!--<Setter Property="Background" TargetName="PART_Border" Value="#ADD8E6"/>
				                                                                                                    <Setter Property="BorderBrush" TargetName="PART_Border" Value="#0000FF"/>-->
                                                                                                            </Trigger>
                                                                                                            <Trigger Property="IsPressed" Value="True">
                                                                                                                <Setter Property="Background" TargetName="PART_Border" Value="{StaticResource Aero.SplitterButtonPressedBackgroundBrush}"/>
                                                                                                                <Setter Property="BorderBrush" TargetName="PART_Border" Value="{StaticResource Aero.SplitterButtonPressedBorderBrush}"/>
                                                                                                                <!--<Setter Property="Background" TargetName="PART_Border" Value="#98B5E2"/>
				                                                                                                    <Setter Property="BorderBrush" TargetName="PART_Border" Value="#316AC5"/>-->
                                                                                                            </Trigger>
                                                                                                        </ControlTemplate.Triggers>
                                                                                                    </ControlTemplate>
                                                                                                </Setter.Value>
                                                                                            </Setter>
                                                                                        </Style>
                                                                                    </Button.Style>
                                                                                </Button>
                                                                                <Button x:Name="PART_HorizontalButton" BorderThickness="1"  ToolTip="Horizontal Split" >
                                                                                    <Button.Style>
                                                                                        <Style  TargetType="{x:Type Button}">
                                                                                            <Setter Property="Background" Value="Transparent"/>
                                                                                            <Setter Property="BorderBrush" Value="Transparent"/>
                                                                                            <Setter Property="BorderThickness" Value="1"/>
                                                                                            <Setter Property="Template" >
                                                                                                <Setter.Value>
                                                                                                    <ControlTemplate TargetType="{x:Type Button}">
                                                                                                        <Border x:Name="PART_Border" VerticalAlignment="Center" HorizontalAlignment="Center" 
				                                                                                                    Margin="0,0,0,0"                 
                                                                                                                    Width="15"
                                                                                                                    Height="15" 
                                                                                                                    Background="{TemplateBinding Background}"
                                                                                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                                                                                    BorderThickness="{TemplateBinding BorderThickness}"                 
				                                                                                                    SnapsToDevicePixels="True"
				                                                                                                    CornerRadius="0">
                                                                                                            <Canvas Width="11" Height="11" SnapsToDevicePixels="True" VerticalAlignment="Center"  HorizontalAlignment="Center">
                                                                                                                <Rectangle Stroke="Black"  Width="11"  Height="11"/>
                                                                                                                <Path Data="M2,5.5L9,5.5"  HorizontalAlignment="Center" Stroke="Black" Fill="Black" VerticalAlignment="Center"/>
                                                                                                            </Canvas>
                                                                                                        </Border>
                                                                                                        <ControlTemplate.Triggers>
                                                                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                                                                <Setter Property="Background" TargetName="PART_Border" Value="{StaticResource Aero.SplitterButtonHoverBackgroundBrush}"/>
                                                                                                                <Setter Property="BorderBrush" TargetName="PART_Border" Value="{StaticResource Aero.SplitterButtonActiveBorderBrush}"/>
                                                                                                                <!--<Setter Property="Background" TargetName="PART_Border" Value="#ADD8E6"/>
				                                                                                                    <Setter Property="BorderBrush" TargetName="PART_Border" Value="#0000FF"/>-->
                                                                                                            </Trigger>
                                                                                                            <Trigger Property="IsPressed" Value="True">
                                                                                                                <Setter Property="Background" TargetName="PART_Border" Value="{StaticResource Aero.SplitterButtonPressedBackgroundBrush}"/>
                                                                                                                <Setter Property="BorderBrush" TargetName="PART_Border" Value="{StaticResource Aero.SplitterButtonPressedBorderBrush}"/>
                                                                                                                <!--<Setter Property="Background" TargetName="PART_Border" Value="#98B5E2"/>
				                                                                                                    <Setter Property="BorderBrush" TargetName="PART_Border" Value="#316AC5"/>-->
                                                                                                            </Trigger>
                                                                                                        </ControlTemplate.Triggers>
                                                                                                    </ControlTemplate>
                                                                                                </Setter.Value>
                                                                                            </Setter>
                                                                                        </Style>
                                                                                    </Button.Style>
                                                                                </Button>
                                                                                <ToggleButton x:Name="PART_Expand_ColapseButtons" 
									                                                    Command="local:TabSplitterCommands.CollapseBottomSelectedItem" ToolTip="Collapse Pane" >
                                                                                    <ToggleButton.Template>
                                                                                        <ControlTemplate TargetType="{x:Type ButtonBase}">
                                                                                            <Border x:Name="PART_Border" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" 
				                                                                                        Margin="0,0,0,0"                 
                                                                                                        Width="15"
                                                                                                        Height="15" 
                                                                                                        Background="Transparent"
                                                                                                        BorderBrush="Transparent"
                                                                                                        BorderThickness="1"                
				                                                                                        SnapsToDevicePixels="True"
				                                                                                        CornerRadius="0">
                                                                                                <Canvas Width="11" Height="11" SnapsToDevicePixels="True" VerticalAlignment="Center"  HorizontalAlignment="Center">
                                                                                                    <Rectangle Stroke="Black"  Width="11"  Height="11"/>
                                                                                                    <Polyline Points="2,5 5.5,8.5 8.5,5" Stroke="Black" StrokeThickness="1.3"/>
                                                                                                    <Polyline Points="2.2,2.2 5.5,5.5 8.5,2.2" Stroke="Black" StrokeThickness="1.3"/>
                                                                                                </Canvas>
                                                                                            </Border>
                                                                                            <ControlTemplate.Triggers>
                                                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                                                    <Setter Property="Background" TargetName="PART_Border" Value="{StaticResource Aero.SplitterButtonHoverBackgroundBrush}"/>
                                                                                                    <Setter Property="BorderBrush" TargetName="PART_Border" Value="{StaticResource Aero.SplitterButtonActiveBorderBrush}"/>
                                                                                                    <!--<Setter Property="Background" TargetName="PART_Border" Value="#ADD8E6"/>
				                                                                                        <Setter Property="BorderBrush" TargetName="PART_Border" Value="#0000FF"/>-->
                                                                                                </Trigger>
                                                                                                <Trigger Property="IsPressed" Value="True">
                                                                                                    <Setter Property="Background" TargetName="PART_Border" Value="{StaticResource Aero.SplitterButtonPressedBackgroundBrush}"/>
                                                                                                    <Setter Property="BorderBrush" TargetName="PART_Border" Value="{StaticResource Aero.SplitterButtonPressedBorderBrush}"/>
                                                                                                    <!--<Setter Property="Background" TargetName="PART_Border" Value="#98B5E2"/>
				                                                                                        <Setter Property="BorderBrush" TargetName="PART_Border" Value="#316AC5"/>-->
                                                                                                </Trigger>
                                                                                            </ControlTemplate.Triggers>
                                                                                        </ControlTemplate>
                                                                                    </ToggleButton.Template>
                                                                                </ToggleButton>
                                                                            </DockPanel>
                                                                            <Border Name="PART_HorizContainerBorder"
                                                                                        HorizontalAlignment="Left">
                                                                                <Border Name="ResizedOptionLine" BorderThickness="0,1,0,1" Width="40" Height="4" BorderBrush="#808080"
                                                                                            HorizontalAlignment="Center"/>
                                                                            </Border>
                                                                        </local:SplitHeaderPanel>
                                                                    </Border>
                                                                    <Canvas Name="DragPreviewLine" Height="3" Visibility="Collapsed">
                                                                        <Line Name="Line1" Stroke="Black" Fill="Black" StrokeDashArray="1,1" StrokeThickness="1" X2="{TemplateBinding ActualWidth}" HorizontalAlignment="Stretch"/>
                                                                        <Line Name="Line2" Stroke="Black" Fill="Black" StrokeDashArray="1,1" StrokeThickness="1" X1="1" Y1="1" Y2="1" X2="{TemplateBinding ActualWidth}" HorizontalAlignment="Stretch"/>
                                                                        <Line Name="Line3" Stroke="Black" Fill="Black" StrokeDashArray="1,1" StrokeThickness="1" Y1="2" Y2="2" X2="{TemplateBinding ActualWidth}" HorizontalAlignment="Stretch"/>
                                                                    </Canvas>
                                                                </local:LayoutPanel>
                                                                <ControlTemplate.Triggers>
                                                                    <Trigger Property="ResizeDirection" Value="Columns" >
                                                                        <Setter Property="LayoutTransform" TargetName="PART_SplitHeaderPanel">
                                                                            <Setter.Value>
                                                                                <RotateTransform Angle="90"/>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                        <Setter Property="X2" TargetName="Line1" Value="{Binding Path=ActualHeight
									                                                , RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:CustomGridSplitter}}}" />
                                                                        <Setter Property="X2" TargetName="Line2" Value="{Binding Path=ActualHeight
									                                                , RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:CustomGridSplitter}}}" />
                                                                        <Setter Property="X2" TargetName="Line3" Value="{Binding Path=ActualHeight
									                                                , RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:CustomGridSplitter}}}" />
                                                                        <Setter Property="LayoutTransform" TargetName="PART_VerticalButton">
                                                                            <Setter.Value>
                                                                                <RotateTransform Angle="90"/>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                        <Setter Property="BorderBrush" TargetName="PART_VerticalButton" Value="{StaticResource Aero.SplitterButtonActiveBorderBrush}"/>
                                                                        <!--<Setter Property="Background" TargetName="PART_HorizontalButton" Value="Transparent"/>-->
                                                                        <Setter Property="BorderBrush" TargetName="PART_HorizontalButton" Value="Transparent"/>
                                                                        <Setter Property="LayoutTransform" TargetName="PART_HorizontalButton">
                                                                            <Setter.Value>
                                                                                <RotateTransform Angle="90"/>
                                                                            </Setter.Value>
                                                                        </Setter>

                                                                    </Trigger>

                                                                </ControlTemplate.Triggers>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </local:CustomGridSplitter.Style>
                                        </local:CustomGridSplitter>
                                        <local:LayoutPanel x:Name="PART_BottomPanel" Grid.Row="2" Grid.Column="1">
                                            <ScrollContentPresenter x:Name="PART_BottomScrollContent"
															Content="{TemplateBinding BottomSelectedContent}"
															ContentSource="BottomSelectedContent"
															Margin="{Binding Path=Padding, RelativeSource={RelativeSource AncestorType={x:Type local:TabSplitter}}}"
														/>
                                        </local:LayoutPanel>
                                    </Grid>

                                </Border>
                            </shared:Border3D>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="UIElement.IsEnabled" Value="False">
                            <Setter Property="TextElement.Foreground" Value="{DynamicResource ResourceKey={x:Static SystemColors.GrayTextBrushKey}}"/>
                        </Trigger>
                        <DataTrigger Binding="{Binding Path=SelectedItem.(local:TabSplitterItem.Orientation),
						 RelativeSource={RelativeSource Self}}" Value="Vertical" >

                            <Setter Property="Grid.Row" TargetName="PART_TopPanel" Value="1"/>
                            <Setter Property="Grid.Column" TargetName="PART_TopPanel" Value="0"/>

                            <Setter Property="Grid.Row" TargetName="PART_Splitter" Value="1"/>
                            <Setter Property="Grid.Column" TargetName="PART_Splitter" Value="1"/>

                            <Setter Property="Grid.Row" TargetName="PART_BottomPanel" Value="1"/>
                            <Setter Property="Grid.Column" TargetName="PART_BottomPanel" Value="2"/>

                            <Setter Property="ResizeDirection" TargetName="PART_Splitter" Value="Columns"/>
                            <Setter Property="Grid.ColumnSpan" TargetName="PART_Splitter" Value="1"/>
                        </DataTrigger>
                        <Trigger Property="HasItems" Value="False">
                            <Setter Property="Visibility" TargetName="PART_Splitter" Value="Collapsed"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="TextElement.Foreground" Value="{DynamicResource ResourceKey={x:Static SystemColors.ControlTextBrushKey}}"/>
        <Setter Property="Control.Padding" Value="4"/>
        <Setter Property="AllowDrop" Value="False"/>
        <Setter Property="Panel.Background" Value="#FFFFFFFF"/>
        <Setter Property="MinHeight" Value="150"/>
        <Setter Property="local:TabSplitter.SelectedBackground" Value="White"/>
        <Setter Property="local:TabSplitter.SelectedForeground" Value="Black"/>
        <Setter Property="local:TabSplitter.MouseOverBackground" Value="Transparent" />
        <Setter Property="local:TabSplitter.MouseOverForeground"  Value="Black"/>
    </Style>

    <LinearGradientBrush x:Key="VS2010.TabPanelBackgroundBrush" StartPoint="0.5, 0" EndPoint="0.5,1">
        <GradientStop Color="#D9D9E6" Offset="0"/>
        <GradientStop Color="#FEFEFE" Offset="1"/>
    </LinearGradientBrush>

    <Style x:Key="TabControlExtstyle" TargetType="{x:Type local:TabControlExt}">
        <!--<Setter Property="TabPanelStyle" Value="{StaticResource VS2010TabPanelAdvStyle}" />-->
        <Setter Property="CloseButtonType" Value="IndividualOnMouseOver"/>
        <Setter Property="TabPanelBackground" Value="{StaticResource VS2010.TabPanelBackgroundBrush}"/>
        <Setter Property="TextElement.Foreground" Value="White"/>
        <Setter Property="Panel.Background" Value="White"/>
        <!--<Setter Property="DragMarkerStyle" Value="{StaticResource VS2010DragMarkerStyle}"/>-->
        <Setter Property="Control.Padding" Value="2"/>
        <Setter Property="AllowDrop" Value="True"/>
        <Style.Triggers>
            <DataTrigger Binding="{Binding Path=IsDisableUnloadTabItemExtContent, RelativeSource={RelativeSource Self}}" Value="False">
                <Setter Property="Control.Template">
                    <Setter.Value>
                        <ControlTemplate  TargetType="{x:Type local:TabControlExt}" >
                            <Border BorderBrush="#FF293955"  Margin="0" BorderThickness="2">
                                <Border BorderBrush="#FFFFE8A6"  Name="btborder" CornerRadius="1.5">
                                    <Grid Name="TabControlGrid" Background="White" 
			  ClipToBounds="False" SnapsToDevicePixels="True" 
			  KeyboardNavigation.TabNavigation="Local">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Name="ColumnDefinition0" />
                                            <ColumnDefinition Width="0" Name="ColumnDefinition1" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" Name="RowDefinition0" />
                                            <RowDefinition Height="*" Name="RowDefinition1" />
                                        </Grid.RowDefinitions>
                                        <local:HeaderPanel Name="HeaderPanel" Grid.Column="0" Grid.Row="0" Panel.ZIndex="1"  
							   Focusable="False" Background="#FF293955"
							   HorizontalAlignment="Left" VerticalAlignment="Top" >
                                            <local:TabPanelAdv x:Name="PART_TabPanel" Focusable="False"  DockPanel.Dock="Right"  
                                               HorizontalAlignment="Left" VerticalAlignment="Top"                                              
                                               Style="{TemplateBinding TabPanelStyle}">
                                                <local:TabLayoutPanel x:Name="PART_TabLayoutPanel" AllowDrop="True" Margin="0,0,0,0"  IsItemsHost="True" KeyboardNavigation.TabIndex="1"  HorizontalAlignment="Left" VerticalAlignment="Top">

                                                </local:TabLayoutPanel>
                                            </local:TabPanelAdv>
                                        </local:HeaderPanel>
                                        <utilsOuter:Border3D  Grid.Column="0" Grid.Row="1" AllowDrop="True"
                                BorderThickness="0,0,0,0" Margin="0,0,0,0"
                                CornerRadius="0" BorderBrush="#FF2C3D5A"
                              KeyboardNavigation.TabIndex="2" KeyboardNavigation.TabNavigation="Local"                                
                                KeyboardNavigation.DirectionalNavigation="Contained" x:Name="ContentPanel">
                                            <Border x:Name="PART_ContentPanelBorder"                        
                        
                        CornerRadius="0"  Background="{TemplateBinding Background}" >
                                                <Border x:Name="PART_ContentPanelInnerBorder"
                            BorderThickness="0"
                            Margin="0"                           
                            Background="{TemplateBinding Background}"
                            CornerRadius="0" >
                                                    <ContentPresenter Content="{TemplateBinding SelectedContent}" AllowDrop="True" 
                                          ContentTemplate="{TemplateBinding SelectedContentTemplate}" 
                                          ContentSource="SelectedContent" Name="PART_SelectedContentHost" 
                                          Margin="{TemplateBinding Control.Padding}"
                                          SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}"  />
                                                </Border>
                                            </Border>
                                        </utilsOuter:Border3D>
                                    </Grid>
                                </Border>
                            </Border>
                            <ControlTemplate.Triggers>
                                <!--<Trigger Property="IsFocus" Value="False">
                                    <Setter TargetName="btborder" Property="Background" Value="#FFCED4DF"/>
                                    <Setter TargetName="btborder" Property="BorderBrush" Value="#FFCED4DF"/>
                                </Trigger>

                                <Trigger Property="IsTabGroupFocus" Value="False">
                                    <Setter Property="TextElement.Foreground" Value="White"/>
                                    <Setter TargetName="btborder" Property="Background" Value="#FF3D5277"/>
                                    <Setter TargetName="btborder" Property="BorderBrush" Value="#FF3D5277"/>
                                </Trigger>-->
                                <Trigger Property="TabControl.TabStripPlacement" Value="Bottom">
                                    <Setter Property="LayoutTransform" TargetName="HeaderPanel">
                                        <Setter.Value>
                                            <RotateTransform Angle="-180"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="Grid.Row" TargetName="HeaderPanel" Value="1"/>
                                    <Setter Property="Grid.Row" TargetName="ContentPanel" Value="0"/>
                                    <Setter Property="RowDefinition.Height" TargetName="RowDefinition0" Value="*"/>
                                    <Setter Property="RowDefinition.Height" TargetName="RowDefinition1" Value="Auto"/>
                                    <Setter Property="FlowDirection" TargetName="HeaderPanel" Value="RightToLeft"/>
                                </Trigger>
                                <Trigger Property="TabControl.TabStripPlacement" Value="Left">
                                    <Setter Property="LayoutTransform" TargetName="HeaderPanel">
                                        <Setter.Value>
                                            <RotateTransform Angle="-90"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="Grid.Row" TargetName="HeaderPanel" Value="0"/>
                                    <Setter Property="Grid.Row" TargetName="ContentPanel" Value="0"/>
                                    <Setter Property="Grid.Column" TargetName="HeaderPanel" Value="0"/>
                                    <Setter Property="Grid.Column" TargetName="ContentPanel" Value="1"/>
                                    <Setter Property="ColumnDefinition.Width" TargetName="ColumnDefinition0" Value="Auto"/>
                                    <Setter Property="ColumnDefinition.Width" TargetName="ColumnDefinition1" Value="*"/>
                                    <Setter Property="RowDefinition.Height" TargetName="RowDefinition0" Value="*"/>
                                    <Setter Property="RowDefinition.Height" TargetName="RowDefinition1" Value="0"/>
                                    <Setter Property="VerticalAlignment" TargetName="HeaderPanel" Value="Bottom"/>
                                    <Setter Property="FlowDirection" TargetName="HeaderPanel" Value="RightToLeft"/>
                                </Trigger>
                                <Trigger Property="TabControl.TabStripPlacement" Value="Right">
                                    <Setter Property="LayoutTransform" TargetName="HeaderPanel">
                                        <Setter.Value>
                                            <RotateTransform Angle="90"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="Grid.Row" TargetName="HeaderPanel" Value="0"/>
                                    <Setter Property="Grid.Row" TargetName="ContentPanel" Value="0"/>
                                    <Setter Property="Grid.Column" TargetName="HeaderPanel" Value="1"/>
                                    <Setter Property="Grid.Column" TargetName="ContentPanel" Value="0"/>
                                    <Setter Property="ColumnDefinition.Width" TargetName="ColumnDefinition0" Value="*"/>
                                    <Setter Property="ColumnDefinition.Width" TargetName="ColumnDefinition1" Value="Auto"/>
                                    <Setter Property="RowDefinition.Height" TargetName="RowDefinition0" Value="*"/>
                                    <Setter Property="RowDefinition.Height" TargetName="RowDefinition1" Value="0"/>
                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="TabControl.TabStripPlacement" Value="Left"/>
                                        <Condition Property="local:TabControlExt.RotateTextWhenVertical" Value="True"/>
                                        <Condition Property="FlowDirection" Value="RightToLeft"/>
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="HeaderPanel" Property="FlowDirection" Value="LeftToRight"/>
                                </MultiTrigger>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding Path=IsAllTabsClosed,RelativeSource={RelativeSource Self}}" Value="True"/>
                                        <Condition Binding="{Binding Path=(utilsOuter:SkinStorage.VisualStyle), RelativeSource={RelativeSource Self}}" Value="Office2003" />
                                    </MultiDataTrigger.Conditions>
                                    <Setter TargetName="PART_TabPanel" Property="Background" Value="Transparent"/>
                                </MultiDataTrigger>
                                <Trigger Property="UIElement.IsEnabled" Value="False">
                                    <Setter Property="TextElement.Foreground" Value="{DynamicResource ResourceKey={x:Static SystemColors.GrayTextBrushKey}}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>

                    </Setter.Value>
                </Setter>
            </DataTrigger>
            <DataTrigger Binding="{Binding Path=IsDisableUnloadTabItemExtContent, RelativeSource={RelativeSource Self}}" Value="True">
                <Setter Property="Control.Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:TabControlExt}" >
                            
                               
                                    <Grid Name="TabControlGrid"  
			  ClipToBounds="False" SnapsToDevicePixels="True" 
			  KeyboardNavigation.TabNavigation="Local">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Name="ColumnDefinition0" />
                                            <ColumnDefinition Width="0" Name="ColumnDefinition1" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" Name="RowDefinition0" />
                                            <RowDefinition Height="*" Name="RowDefinition1" />
                                        </Grid.RowDefinitions>
                                        <local:HeaderPanel Name="HeaderPanel" Grid.Column="0" Grid.Row="0" Panel.ZIndex="1"  
							   Focusable="False" Background="{TemplateBinding TabPanelBackground}"
							   HorizontalAlignment="Left" VerticalAlignment="Top">

                                            <local:TabPanelAdv x:Name="PART_TabPanel" Focusable="False"  DockPanel.Dock="Right"  
                                               HorizontalAlignment="Left" VerticalAlignment="Top"                                              
                                               Style="{TemplateBinding TabPanelStyle}">
                                                <local:TabLayoutPanel x:Name="PART_TabLayoutPanel" AllowDrop="True" Margin="0,0,2,0"  IsItemsHost="True" KeyboardNavigation.TabIndex="1"  HorizontalAlignment="Left" VerticalAlignment="Top">

                                                </local:TabLayoutPanel>
                                            </local:TabPanelAdv>
                                        </local:HeaderPanel>
                                        <utilsOuter:Border3D Grid.Column="0" Grid.Row="1" AllowDrop="True"
                                BorderThickness="2"
                                CornerRadius="0"
                                Name="ContentPanel" KeyboardNavigation.TabIndex="2" KeyboardNavigation.TabNavigation="Local"                                
                                KeyboardNavigation.DirectionalNavigation="Contained">
                                            <Border x:Name="PART_ContentPanelBorder"                        
                        BorderThickness="0"
                        CornerRadius="0" >
                                                <Border x:Name="PART_ContentPanelInnerBorder"
                            BorderThickness="0"
                            Margin="0"                           
                            Background="{TemplateBinding Background}"
                            CornerRadius="0" >
                                                    <Grid x:Name="PART_ContentHolder"  Margin="{TemplateBinding Control.Padding}" AllowDrop="True"  SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />

                                                </Border>
                                            </Border>
                                        </utilsOuter:Border3D>
                                    </Grid>
                                
                            
                            <ControlTemplate.Triggers>
                                <!--<Trigger Property="IsFocus" Value="False">
                                    <Setter TargetName="btborder" Property="Background" Value="#FFCED4DF"/>
                                    <Setter TargetName="btborder" Property="BorderBrush" Value="#FFCED4DF"/>
                                </Trigger>
                                <Trigger Property="IsTabGroupFocus" Value="False">
                                    <Setter Property="TextElement.Foreground" Value="White"/>
                                    <Setter TargetName="btborder" Property="Background" Value="#FF3D5277"/>
                                    <Setter TargetName="btborder" Property="BorderBrush" Value="#FF3D5277"/>
                                </Trigger>-->
                                <Trigger Property="TabControl.TabStripPlacement" Value="Bottom">
                                    <Setter Property="LayoutTransform" TargetName="HeaderPanel">
                                        <Setter.Value>
                                            <RotateTransform Angle="-180"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="Grid.Row" TargetName="HeaderPanel" Value="1"/>
                                    <Setter Property="Grid.Row" TargetName="ContentPanel" Value="0"/>
                                    <Setter Property="RowDefinition.Height" TargetName="RowDefinition0" Value="*"/>
                                    <Setter Property="RowDefinition.Height" TargetName="RowDefinition1" Value="Auto"/>
                                    <Setter Property="FlowDirection" TargetName="HeaderPanel" Value="RightToLeft"/>
                                </Trigger>
                                <Trigger Property="TabControl.TabStripPlacement" Value="Left">
                                    <Setter Property="LayoutTransform" TargetName="HeaderPanel">
                                        <Setter.Value>
                                            <RotateTransform Angle="-90"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="Grid.Row" TargetName="HeaderPanel" Value="0"/>
                                    <Setter Property="Grid.Row" TargetName="ContentPanel" Value="0"/>
                                    <Setter Property="Grid.Column" TargetName="HeaderPanel" Value="0"/>
                                    <Setter Property="Grid.Column" TargetName="ContentPanel" Value="1"/>
                                    <Setter Property="ColumnDefinition.Width" TargetName="ColumnDefinition0" Value="Auto"/>
                                    <Setter Property="ColumnDefinition.Width" TargetName="ColumnDefinition1" Value="*"/>
                                    <Setter Property="RowDefinition.Height" TargetName="RowDefinition0" Value="*"/>
                                    <Setter Property="RowDefinition.Height" TargetName="RowDefinition1" Value="0"/>
                                    <Setter Property="VerticalAlignment" TargetName="HeaderPanel" Value="Bottom"/>
                                    <Setter Property="FlowDirection" TargetName="HeaderPanel" Value="RightToLeft"/>
                                </Trigger>
                                <Trigger Property="TabControl.TabStripPlacement" Value="Right">
                                    <Setter Property="LayoutTransform" TargetName="HeaderPanel">
                                        <Setter.Value>
                                            <RotateTransform Angle="90"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="Grid.Row" TargetName="HeaderPanel" Value="0"/>
                                    <Setter Property="Grid.Row" TargetName="ContentPanel" Value="0"/>
                                    <Setter Property="Grid.Column" TargetName="HeaderPanel" Value="1"/>
                                    <Setter Property="Grid.Column" TargetName="ContentPanel" Value="0"/>
                                    <Setter Property="ColumnDefinition.Width" TargetName="ColumnDefinition0" Value="*"/>
                                    <Setter Property="ColumnDefinition.Width" TargetName="ColumnDefinition1" Value="Auto"/>
                                    <Setter Property="RowDefinition.Height" TargetName="RowDefinition0" Value="*"/>
                                    <Setter Property="RowDefinition.Height" TargetName="RowDefinition1" Value="0"/>
                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="TabControl.TabStripPlacement" Value="Left"/>
                                        <Condition Property="local:TabControlExt.RotateTextWhenVertical" Value="True"/>
                                        <Condition Property="FlowDirection" Value="RightToLeft"/>
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="HeaderPanel" Property="FlowDirection" Value="LeftToRight"/>
                                </MultiTrigger>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding Path=IsAllTabsClosed,RelativeSource={RelativeSource Self}}" Value="True"/>
                                        <Condition Binding="{Binding Path=(utilsOuter:SkinStorage.VisualStyle), RelativeSource={RelativeSource Self}}" Value="Office2003" />
                                    </MultiDataTrigger.Conditions>
                                    <Setter TargetName="PART_TabPanel" Property="Background" Value="Transparent"/>
                                </MultiDataTrigger>
                                <Trigger Property="UIElement.IsEnabled" Value="False">
                                    <Setter Property="TextElement.Foreground" Value="{DynamicResource ResourceKey={x:Static SystemColors.GrayTextBrushKey}}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>

                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
        </Style.Triggers>
    </Style>

</ResourceDictionary>


          